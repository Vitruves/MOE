<!DOCTYPE html>
<html>

<!--
!!    MOE On-Line Manuals
!!    COPYRIGHT (C) CHEMICAL COMPUTING GROUP ULC.  ALL RIGHTS RESERVED.
!!-->
<head>
  <meta http-equiv="x-ua-compatible" content="IE=9" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="../include/manstyle.css" />
  <link rel="icon" type="image/png" href="../images/ccgicon.png" />
  <link rel="shortcut icon" type="image/png" href="../images/ccgicon.png" />
  <title>Structure-Activity Report</title>
  <meta name="keywords" content="panel: Structure-Activity Report" />
</head>
<body>
<div class="center-page">
  <!-- START MOE_HEADER -->
  <div class="MOE_HEADER">
    <a href="../index.htm"><img src="../images/ccglogo.png" /></a>
    <a href="../index.htm"><div class="moeversion"></div></a>
    Structure-Activity Report
  </div>
<!-- END MOE_HEADER -->
<div class="content">
  <ul>
    <li>
      <a href="#Overview">Overview</a>
    </li>
    <li>
      <a href="#Methodology">Methodology</a>
    </li>
    <li>
      <a href="#Data">Data</a>
      <ul>
        <li>
          <a href="#Molecules">Molecules</a>
        </li>
        <li>
          <a href="#Activities">Activities</a>
        </li>
        <li>
          <a href="#OtherFields">Other fields</a>
        </li>
        <li>
          <a href="#Scaffolds">Scaffolds</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="#Execution">Running SAReport</a>
      <ul>
        <li>
          <a href="#SetupPanel">Setup Panel</a>
        </li>
        <li>
          <a href="#CommonFragment">Common Fragment Analysis Panel</a>
        </li>
        <li>
          <a href="#MOEWeb">MOE/web</a>
        </li>
        <li>
          <a href="#Batch">Batch</a>
        </li>
        <li>
          <a href="#Units">Unit Types File</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="#Results">Results</a>
      <ul>
        <li>
          <a href="#TabSummary">Summary</a>
        </li>
        <li>
          <a href="#TabScaffolds">Scaffolds</a>
        </li>
        <li>
          <a href="#TabActivity">Activity</a>
        </li>
        <li>
          <a href="#TabSuggestions">Suggestions</a>
        </li>
        <li>
          <a href="#TabExplore">Explore</a>
        </li>
        <li>
          <a href="#TabGraphs">Graphs</a>
        </li>
        <li>
          <a href="#TabFragments">Fragments</a>
        </li>
        <li>
          <a href="#TabData">Data</a>
        </li>
      </ul>
    </li>
  </ul>
  <!-- ============================== OVERVIEW ============================= -->
<a id="Overview"></a>
<h1>Overview</h1>

<p>The Structure-Activity Report is a MOE application which generates a web
  page housing an interactive view onto a collection of molecules which are
  related by a small number of related common scaffolds. The application is
  designed to operate on small databases of drug-like molecules which are in
  the process of being refined for improved binding affinity and other
  pharmacological properties.</p>

<p>The input data is typically a collection of lead candidate structures,
  ideally consisting of between 100 and 1000 molecules, each of which features
  an activity value for inhibition of at least one drug target. Detection of
  common scaffolds can be done automatically, or the user can supply
  suggestions. Correlation and assignment of molecules to multiple possible
  scaffolds is achieved by an algorithm which can operate with or without
  guidance from the operator. Specialized depiction methods are used to present
  scaffolds and R-groups.</p>

<p>The HTML page which is generated by the report application contains a
  number of tabs for examining the common scaffolds, R-groups, structure vs.
  activity, fragmentation, and various graphs and interactive widgets. The
  output can be viewed independently of MOE, but major changes to the content
  such as adding molecules or modifying the scaffolds requires rebuilding the
  page.</p>

<p>Reports can be generated using a panel from an interactive session of MOE,
  using a MOE molecular database or an MDL SD-file as the main input. The
  default browser will be launched when the generation is complete.
  Alternatively, the Structure-Activity Report can be accessed from MOE/web,
  which allows input data and parameters to be specified through the portal
  page. Thirdly, the reports can be generated from the command line, using
  MOE/batch, which allows the process to be scripted.
  <!-- ========================== METHODOLOGY ========================== --></p>
<a id="Methodology"></a>
<h1>Methodology</h1>

<p>The scaffold detection and assignment procedure has been published in the
  literature [Clark 2009]. The calculations which are required to produce the
  Structure-Activity Report proceed through the following steps:</p>
  <ol>
    <li>Gather input data (molecules, activity, predefined scaffolds,
    etc.).</li>
    <li>Detect common scaffolds, if enabled, and append them to any predefined
    scaffolds.</li>
    <li>If more than one scaffold is present, topologically align them to
    produce a common numbering system.</li>
    <li>Assign the scaffolds by enumerating all possible substructure matches,
    then minimizing a pairwise energy term which leads to the lowest possible
    diversity of implied R-group substituents.</li>
    <li>Clip the implied R-groups and gather them into unique sets, then
    decorate the scaffolds with numbered R-group labels.</li>
    <li>Produce a 2D layout for each scaffold such that the planar alignment
    shows equivalent substitution positions.</li>
    <li>Render each of the molecules, scaffolds, R-groups and fragments as
    images, as well as SD files.</li>
    <li>Write the HTML output, including any embedded information required for
    interactivity in conjunction with the supporting JavaScript libraries.</li>
  </ol>
  <!-- ================================ DATA =============================== -->
<a id="Data"></a>
<h1>Data</h1>

<p>The minimum requirement for generating a Structure-Activity Report is a
  collection of molecules. Most of the features of the output only apply if
  there is at least one field which is classified as an activity value, such as
  a K<sub>i</sub>, <i>p</i>K<sub>i</sub>, IC<sub>50</sub> or
  <i>p</i>IC<sub>50</sub> measurement. Common scaffolds may be supplied by the
  user, but if omitted, they will be calculated automatically.</p>
<a id="Molecules"></a>
<h2>Molecules</h2>

<p>The molecular data for which the Structure-Activity Report will be
  generated must be supplied in the form of either a MOE molecular database
  (<tt>.mdb</tt>), or an MDL SD-file (<tt>.sdf</tt>). The number of input
  molecules should be between 100 and 1000 molecules for ideal performance, but
  larger or smaller datasets are possible.</p>

<p>Each of the molecules should be a ligand which is relevant to the
  particular project. Proteins must not be included in the molecule field.
  Salts, adducts, solvent molecules, etc. should ideally be removed first,
  though this can be done automatically. Best results are typically obtained if
  the molecules are drawn in their neutral form, with whichever tautomer state
  is most consistent throughout the series, rather than the form which is
  thought to be adopted in a particular binding mode.</p>

<p>If the coordinates of the input molecules are in the form of 2D sketches,
  the existing coordinates may be used as layout hints during depiction of
  automatically detected scaffolds [Clark 2006]. For SD files, coordinates are
  used to determine stereochemistry for alkenes. The input coordinates are
  otherwise unimportant, and all molecules will be redrawn during the
  generation of the report.</p>
<a id="Activities"></a>
<h2>Activities</h2>

<p>Many of the features provided in the final report are predicated on the
  availability of at least on data field which is classified as a type of
  activity. Examples of activity fields include:</p>
  <ul>
    <li><tt>pKi/pIC50</tt></li>
    <li><tt>Ki/IC50</tt></li>
    <li><tt>percentages</tt></li>
    <li><tt>boolean</tt></li>
  </ul>
<a id="OtherFields"></a>
<h2>Other fields</h2>

<p>Non-activity data field types numeric properties and text ID fields, which
  are displayed in various parts of the report.</p>
<a id="Scaffolds"></a>
<h2>Scaffolds</h2>

<p>In order for the scaffold categorization to be effective, it is necessary
  for the majority of the molecules to be based on a small number of common
  scaffolds. These common scaffolds should have significant points of
  structural similarity with one another, such that they form an analogous
  series. For example, the following two molecules are obviously based on a
  similar scaffold:</p>
  <div align="center"><img src="sar/analog_1.png" /> <img src=
  "sar/analog_2.png" /></div>

<p>The following two molecules do not obviously share a common scaffold
  motif:</p>
  <div align="center"><img src="sar/analog_3.png" /> <img src=
  "sar/analog_4.png" /></div>

<p>For datasets containing molecules which are largely based on the same
  scaffold, or largely based on scaffolds which have a high degree of
  structural similarity, the automated scaffold detection and analysis
  algorithms are likely to be effective. For molecules based on scaffolds which
  are very different from one another, but nonetheless have consistent meaning
  throughout the series, it may be necessary to provide the scaffolds as input,
  since the automatic detection methods may fail to find all of the scaffolds,
  or may fail to align them correctly. Molecules which are based on scaffolds
  that are not primarily ring blocks are less likely to be detected
  automatically, and may need their scaffolds to be specified by the user.</p>

<p>Scaffolds can be provided by the user in common molecular sketch formats,
  e.g. MDL MOL files, or from the content of the MOE Window. User-supplied
  scaffolds can optionally be augmented with scaffolds which have been detected
  automatically.</p>

<p>The minimum requirement for a user-specified scaffold is a substructure
  fragment, with no special annotations. Scaffold substructure fragments may
  only be decorated by singly bonded substituents, i.e. double, triple or
  aromatic bonds to R-groups are forbidden. This means that partial aromatic
  ring blocks will not match (e.g. benzene is not a scaffold substructure of
  napthalene), nor will fragments with pendant double bonds (e.g. ethane is not
  a scaffold substructure of ethanal). These restrictions can be circumvented
  by supplying multiple scaffolds. Bi- or multi-dentate R-groups are allowed,
  which means that scaffold substructures can match parts of ring blocks, as
  long as they are attached by single, non-aromatic bonds. Tautomers and
  protonation states are applied as-drawn, and are not automatically adjusted
  (e.g. keto forms of substructures will not match molecules drawn in the enol
  form, nor will a neutral amine match a protonated amine), but aromatic bonds
  drawn in the Kekul&eacute; form will be normalized automatically.</p>

<p>In the case of multiple scaffolds, it is typically presumed that the data
  is part of an analogous series, which might be annotated as:</p>
  <div align="center"><img src="sar/analogR_1.png" /> <img src=
  "sar/analogR_2.png" /></div>

<p>The positions indicated by R1 for each molecule are, for this example,
  considered analogous substitution points, as are the positions indicated by
  R2. These positions have common meaning for the molecules, regardless of
  which of these two scaffolds they are based on. If the scaffolds are not
  provided by the user, or the provided scaffolds have no extra annotation, the
  equivalences of the substitution points will be calculated automatically. In
  some cases, however, the relationship between the substitution points is not
  obvious from the scaffold structure, or from the available substituents, and
  so it can be necessary for the user to provide this information. The most
  straightforward way to do this is to use the Markush notation, as shown
  above, using R-group labels, with a common numbering system throughout the
  series. These labels will be strictly honored during the scaffold assignment
  process.
  <!-- ============================== EXECUTION ============================ --></p>
<a id="Execution"></a>
<h1>Running SAReport</h1>
<a id="SetupPanel"></a>
<h2>Setup Panel</h2>

<p>The Structure-Activity Report can be generated from within an interactive
  MOE session by choosing <nobr><b>Compute | QuaSAR | SAReport...</b></nobr> ,
  the <nobr><b>DBV | Compute | SAReport...</b></nobr> , or from within the
  <nobr><b>MOE | File | Open</b></nobr> dialog, by selecting an MDB or SDF
  file, and setting <b>Action</b> to SAReport. It can also be accessed by
  running the file <nobr><tt>sareport.svl</tt></nobr>.</p>

<p>The Structure-Activity Report setup panel is shown below in two states:
  (1) initial blank, and (2) all fields fully specified:</p>
  <div align="center"><img src="sar/sareport_panel.png" alt=
  "Structure-Activity Report Panel" />&nbsp; <img src=
  "sar/sareport_dhfr.png" /></div>

<p>The fields in the setup panel are configured as follows:</p>
  <table class="titlebar">
    <tr>
      <th>Section</th>
      <th>Description</th>
    </tr>
    <tr>
      <td valign="top"><b>Scaffolds</b></td>
      <td valign="top">
        The top half of the setup panel is reserved for displaying any
        user-specified scaffolds that will be used during the analysis. If no
        scaffolds are provided, then automatic scaffold detection is
        compulsory. If scaffolds have been provided, the <b>Auto-detect</b>
        checkbox may be used to toggle whether the analysis searches for
        <i>additional</i> common scaffolds, beyond those specified in this
        panel.

<p>Scaffolds can be obtained by clicking on the <b>Paste</b> or <b>Copy
        From MOE</b> buttons, or they can be read from a file by clicking on
        the <b>Browse...</b> button. To remove the scaffolds, click on
        <b>Clear</b>. The currently defined scaffolds can be copied to the MOE
        window using the <b>Copy To MOE</b> button.</p>
      </td>
    </tr>
    <tr>
      <td valign="top"><b>Title</b></td>
      <td valign="top">An optional title may be provided, which will be
      displayed in the summary section of the resulting HTML page.</td>
    </tr>
    <tr>
      <td valign="top"><b>Tabs</b></td>
      <td valign="top">The output report consists of a collection of tabs, each
      of which exposes a particular feature. These tabs can be switched on or
      off with the corresponding checkbox in the setup panel. Disabling any of
      the tabs will reduce the overhead required to generate the corresponding
      data, which can lead to a smaller HTML page, fewer images, and a shorter
      loading time for the resulting report. If the tab is subsequently
      required, however, the only way to restore it is to regenerate the
      report.</td>
    </tr>
    <tr>
      <td valign="top"><b>Input File</b></td>
      <td valign="top">An input database file must be specified before the
      report can be produced. The file must be a MOE molecular database (.mdb)
      or an MDL SD file (.sdf). The file can be selected by using the
      <b>Browse...</b> button, or entered in the text field. For the latter
      method, it is necessary to press the <tt>ENTER</tt> key afterward, which
      will trigger an analysis of the fields contained within the file.</td>
    </tr>
    <tr>
      <td valign="top"><b>Analyze</b></td>
      <td valign="top">The input molecules are analyzed to suggest potential
      scaffold groups presented in a grid. The scaffolds can be selected and
      used as user-specified scaffolds.</td>
    </tr>
    <tr>
      <td valign="top"><b>Retain Analysis</b></td>
      <td valign="top">
        When the input file is a writable MOE Molecular Database
        (<tt>.mdb</tt>), this checkbox may be enabled, which will cause the
        scaffold assignment information to be stored in the database for future
        use. This means that after the report has been generated, the list of
        scaffolds, and the way in which they are assigned to individual
        molecules, will be retrieved next time the setup panel is run on the
        database.

<p>Apart from conveniently storing the list of scaffolds within the
        same database, this feature is particularly useful for datasets which
        grow over time. Without retaining the analysis, it is possible that
        adding new molecules to a dataset will change the way scaffolds are
        detected and assigned. When the analysis is retained, it is assured
        that old molecules will always be assigned to the same scaffolds in the
        same way, and newly added molecules will be assigned with the
        underlying algorithms, using the existing pattern as a guideline.</p>
      </td>
    </tr>
    <tr>
      <td valign="top"><b><nobr>Selected fields Only</nobr><br />
      <nobr>Selected Entries Only</nobr></b></td>
      <td valign="top">If the input file is a MOE molecular database, which is
      currently open with the database viewer, the entries and fields can be
      restricted to those which are selected.</td>
    </tr>
    <tr>
      <td valign="top"><span class="menu">Grow Scaffolds</span></td>
      <td valign="top">If on and if the implied R-group substituents are
      completely uniform, the scaffold will be grown by absorbing the
      substituents. If off, the scaffolds are used as-is.</td>
    </tr>
    <tr>
      <td valign="top"><b>Molecule Names</b></td>
      <td valign="top">If on, then the molecular name field for the input
      molecules will be used to create an implied field. If all of the molecule
      names are blank, this has no effect.</td>
    </tr>
    <tr>
      <td valign="top"><b>Largest Component</b></td>
      <td valign="top">If on, each input molecule will be divided up into
      connected components, and only the largest retained. This will usually
      strip out salts, solvents or adducts.</td>
    </tr>
    <tr>
      <td valign="top"><b>Neutralize</b></td>
      <td valign="top">If on, then charged molecules (acids and bases) will be
      submitted to an algorithm which attempts to remove charges by balancing
      the protonation state. For most druglike molecules, this will result in a
      molecular species for which all heavy atoms are neutral.</td>
    </tr>
    <tr>
      <td valign="top"><b>fields</b></td>
      <td valign="top">
        When an input database is defined, a list of non-molecular fields is
        provided. The types for input fields are determined automatically, by
        matching the field names and range of values with expected properties.
        The automatic type determination may be overridden as necessary.

<p>When one or more of the fields in the list is selected, the
        drop-down box labeled <b>Type</b> is made available, and may be used to
        specify the type for the selected fields. The list of types is
        determined by the contents of the <a href="#Units"><b>unit types
        file</b></a>.</p>

<p>Two type options are always available: <tt>skip</tt>, which causes
        the field to be ignored, and <tt>ID</tt>, which is used when the field
        is a short text description, such as an ID number, name or registration
        code. Use of a large number of ID fields, or ID fields which are more
        than several dozen characters long, is not recommended, as it will
        impair the layout of the final report.</p>
      </td>
    </tr>
    <tr>
      <td valign="top"><b>Output To</b></td>
      <td valign="top">
        Generation of the Structure-Activity report involves the creation of a
        large number of files, which are written to a user-supplied directory.
        By default this is a subdirectory called <tt>sareport_html</tt> within
        the current working directory. It should be changed as necessary. The
        directory will be created if it does not exist.

<p>Note that if the output directory already contains files, they will
        <i>not</i> be explicitly deleted, but they will be overwritten if they
        have the same name. If a single directory is used to generate a
        Structure-Activity Report multiple times, only the most recently
        generated report will be available. There may be some residual files
        from previous reports, which are not referenced.</p>
      </td>
    </tr>
  </table>

<p>Once configuration of the options is complete, press the <b>Produce</b>
  button. If a directory needs to be created for the output, a confirmation
  prompt will be issued. The generation of the Structure-Activity Report is
  done independently of the panel, so it may be closed at any time. Once the
  report is complete, the current browser will be launched, with the resulting
  HTML document as the opening page.</p>
<a id="CommonFragment"></a>
<h2>Common Fragment Analysis Panel</h2>

<p>The Common Fragment Analysis panel is launched from the <b>Analyze</b>
  button of the Structure-Activity Report setup panel. It allows the user the
  possibility of pre-specifying candidate scaffolds bypassing the scaffold
  detection algorithm.</p>

<p>In this application, a grid of molecule fragments is presented to the user
  revealing common scaffold classes along with statistics on number of matched
  molecule, number of heavy atoms, as well as, the maximum similarity to any
  already picked scaffold.</p>
  <div align="center"><img src="sar/cmnfrag.png" alt=
  "Common Fragment Analysis Panel" /></div>

<p>The top half of the setup panel is reserved for displaying any
  user-specified scaffolds that will be used during the analysis. The bottom
  half is used to list the remaining available scaffold groups.</p>

<p>The molecular field can be set to the input database by setting
  <b>Molecule&nbsp;field</b>. The calculation can be performed on a subset with
  the <b>Selected&nbsp;Entries&nbsp;Only</b>. <b>Substructure</b> can be
  enabled to include substructure search in addition to the fragment
  decomposition.</p>

<p>The selected scaffolds can be copied to the clipboard with
  <b>Copy&nbsp;MOL</b> or copied to the MOE window with
  <b>Copy&nbsp;To&nbsp;MOE</b>.</p>

<p>The <b>Back</b> button can be used to undo a selection, while the
  <b>Reset</b> button will clear all selected scaffolds from the top half.
  <b>Write</b> can be used to populate a field, <tt>$CORE</tt>, allowing for
  partitioning the data on matched scaffolds. <b>Select</b> will set the
  database selection state in the database viewer.</p>
<a id="MOEWeb"></a>
<h2>MOE/web</h2>

<p>The Structure-Activity Report is also implemented as part of the MOE/web
  collection, and provides an entry point:</p>
  <div align="center"><img src="sar/moeweb1.png" /></div>

<p>The entry page has a single section, which requires a file to be
  submitted. Once the file has been subjected to a preliminary parsing, the
  MOE/web setup page is presented:</p>
  <div align="center"><img src="sar/moeweb2.png" /></div>

<p>The MOE/web setup page is largely analogous to the MOE panel equivalent.
  The main difference is that MOE does not need to be installed on the desktop
  from which the report was produced. The user must present an input file,
  optionally provide scaffolds, clarify any numeric fields which were not
  automatically typed, and select several options.</p>

<p>The MOE/web server automatically manages the creation of an output
  directory, and previously generated reports will reside on the server for a
  certain duration.</p>
<a id="Batch"></a>
<h2>Batch</h2>

<p>A report can be produced without an interface, by calling an SVL function
  directly, e.g.</p>

<pre>
    arg = [fn, dir, scaffolds, opt];
    run ['sareport.svl', arg, 'sareport_Generate'];
</pre>

<p>where <tt>fn</tt> is the filename of the input molecule source and
  <tt>dir</tt> is the filename of the output directory. The <tt>scaffolds</tt>
  parameter may be null, or an array of CTAB structures which specify the
  scaffolds. <tt>opt</tt> is a tagged vector which contains any optional
  behavior.</p>

<p>To generate the report from MOE/batch, the following shell syntax can be
  used, in POSIX environments:</p>

<pre>
    $MOE/bin/moebatch -exec &quot;arg = [fn, dir, scaffolds, opt]; \
                             run ['sareport.svl', arg, 'sareport_Generate']&quot;
</pre>
<a id="Units"></a>
<h2>Unit Types File</h2>

<p>Unit schemes for activities and properties are programmable, and are read
  from the file <nobr><tt>$MOE/web/sareport/units.txt</tt></nobr>. If a copy of
  the file exists in the current working directory, that will be used
  instead.</p>

<p>It is possible to add or modify the way units work by editing this file.
  There are two main types of units: activities and properties. Activities are
  used to color-code molecules in various parts of the report. The unit types
  file contains formula parameters necessary to transform the input data into
  normalized values.</p>

<p>The default activity types are:</p>
  <ul>
    <li><b>pKi/pIC50</b>: activity values of the K<sub>i</sub> or
    IC<sub>50</sub> type, originally in molar units, but converted to
    <tt>-log<sub>10</sub></tt>, i.e. a value of 6 corresponds to
    10<sup>-6</sup> mol/L, or 1 &mu;mol/L. This scheme is balanced so that 6.5
    is the mid-point. The mid-point for a particular color scheme is the
    critical region, away from which the color change is rapid. For the
    &quot;heat-map&quot; scheme, the mid-point is rendered in yellow, while
    higher values are green and lower values are red.</li>
    <li><b>Ki/IC50</b>: activity values of the K<sub>i</sub> or IC<sub>50</sub>
    type, in molar concentration. This scheme is balanced so that
    10<sup>-6.5</sup> is the mid-point.</li>
    <li><b>Ki/IC50(uM)</b>: as for the <b>Ki/IC50</b> type, except that the
    values are provided in micro-molar concentration, i.e. the scale is
    multiplied by 10<sup>6</sup>.</li>
    <li><b>fraction</b>: the input values are supplied as numbers between 0 and
    1, where 0 means inactive, while 1 means maximum activity. This can also be
    used for boolean activity.</li>
    <li><b>percent</b>: as for <b>fraction</b>, except that the range is
    0&ndash;100.</li>
  </ul>

<p>By default there is only one property type, which is named
  <b>property</b>. It is not transformed in any way. Property types are only
  used for a limited range of features with the report, e.g. graphs.</p>

<p>For more information about configuring units, refer to the explanatory
  comments in <nobr><tt>$MOE/web/sareport/units.txt</tt></nobr>.
  <!-- =============================== RESULTS ============================= --></p>
<a id="Results"></a>
<h1>Results</h1>

<p>A large number of files are generated for each Structure-Activity Report.
  Many of the primary output files are written to the directory supplied during
  the generation steps (<tt>$OUTDIR</tt>), while the numerous image files are
  placed in the <tt>$OUTDIR/img</tt> subdirectory, one level deeper.</p>

<p>The main entry point is <tt>$OUTDIR/index.htm</tt>. Opening this page in
  any modern browser should be sufficient to access all of the features of the
  report. The following browsers have been tested:</p>
  <ul>
    <li>Mozilla Firefox (versions 2 and 3)</li>
    <li>Internet Explorer (versions 6, 7 and 8)</li>
    <li>Konqueror (version 3.5)</li>
    <li>Safari (version 10.5)</li>
    <li>Opera (version 9.5)</li>
    <li>Chrome</li>
  </ul>
<a id="TabSummary"></a>
<h2>Summary</h2>

<p>When the Structure-Activity Report is opened in the browser, the
  <b>Summary</b> tab is always shown first. The display should somewhat
  resemble the following:</p>
  <div align="center"><img src="sar/tabsummary.png" /></div>

<p>A section is created for each scaffold, which is denoted by the wide
  turquoise bars. These sections can be checked open and closed by clicking on
  the [+]/[-] icons on the left side.</p>

<p>Within each section, the scaffold itself is displayed prominently on the
  left, with numbered R-group decorations showing where substituents can be
  found. Underneath the scaffold depiction is shown the number of molecules
  which were assigned to the scaffold, and for each activity value, a summary
  histogram providing a preliminary indication of the range of activity
  values.</p>

<p>To the right of the scaffold is a vertical list of each of the R-group
  substitution positions found on the scaffold. To the right of each of these
  labels is a graphical list of the unique set of substitutions which may be
  found at that substitution position, on that scaffold.</p>

<p>Moving the mouse over any one of the R-group values brings up a popup
  window:</p>
  <div align="center"><img src="sar/mouseover.png" /></div>

<p>The popup window shows information about each of the molecules which
  possess the underlying R-group at the specific position on the indicated
  scaffold. If there are more than 12 such molecules, then only a subset of the
  molecules are shown. To see all of the molecules, left-click on the R-group
  of interest, which will bring up a persistent popup window which has its own
  scrollbar.</p>
<a id="TabScaffolds"></a>
<h2>Scaffolds</h2>

<p>The <b>Scaffolds</b> tab allows the scaffolds to be edited, and also
  provides information about any molecules in the dataset which did not match a
  scaffold. When selected, the tab may look something like:</p>
  <div align="center"><img src="sar/tabscaffold.png" /></div>

<p>The main part of the page is taken up by a Java sketcher applet, which
  shows each of the scaffolds used within the current report. The sketcher may
  be used to modify, add or remove scaffolds. To apply a different set of
  scaffolds, it is necessary to rebuild the report, which can be done by
  clicking the <nobr><b>Copy to Clipboard</b></nobr> button, then returning to
  the MOE setup panel, and using the <b>Paste</b> button.</p>

<p>Note that the sketcher applet requires Java 1.5 or later installed as a
  browser plugin. Without a suitable version of Java, this feature will be
  disabled.</p>

<p>Underneath the sketcher applet is a list of <b>Unused Molecules</b>, for
  which no scaffold was found, if there are any. Clicking on any of these
  molecules will cause it to be pasted into the sketcher applet, which is a
  convenient way to edit scaffold prototypes.</p>

<p>The last section, entitled <b>Clipboard Information</b>, contains
  browser-specific information for enabling use of the clipboard.</p>
<a id="TabActivity"></a>
<h2>Activity</h2>

<p>The <b>Activity</b> tab has as its main focus a <b>Correlation Table</b>,
  which singles out two degrees of freedom (scaffold, R1, R2, etc.), and plots
  them against each other. An example of such a table is:</p>
  <div align="center"><img src="sar/tabactivity2.png" /></div>

<p>As can be seen, the different scaffolds are plotted in the row axis
  header, and the possible values for the R2 substituent are plotted in the
  column header.</p>

<p>Each of the cells for which there is activity data is color coded. By
  default, just one activity is plotted, and the &quot;heat map&quot; color
  scheme is used, in which green denotes highly active, red denotes inactive,
  and yellow denotes mediocre activity.</p>

<p>The row and column headers each show bands of color, which represent the
  average activity for the whole row or column. For individual cells which
  represent one or two molecules, the numeric activity values are shown
  explicitly; for more than 2, a range is given.</p>

<p>Moving the mouse cursor over a non-empty cell, or a row or column heading,
  brings up a popup menu which shows information about the compounds being
  represented. Left-clicking brings up a persistent window with more detailed
  information.</p>

<p>Left-clicking on a cell or heading with the <tt>Ctrl</tt> key held down
  causes the selection state of all represented compounds to be toggled on or
  off.</p>

<p>Some of the empty cells may be represented with small
  &quot;starburst&quot; patterns (groups of black dots arranged in a circle).
  These are shown when the corresponding degrees of freedom (e.g. Scaffold +
  R2) for the cell are unusually over-represented amongst compounds with
  greater than average activity. In effect it is a statement that the available
  data suggests that a new compound with these two features is likely to be
  more active than most of the compounds currently in the dataset. The size of
  the starburst is proportional to the weight of the prediction.</p>

<p>Only one correlation table can be displayed at any given time, but its
  contents can be adjusted using the controls which are shown above it, in the
  <b>Activity Selector</b> panel:</p>
  <div align="center"><img src="sar/tabactivity3.png" /></div>

<p>The Rows and Columns parts are used to select which degrees of freedom are
  plotted along the two axes. Changing either of these will cause the content
  of the table to be reconstructed.</p>

<p>The sort order for either of the axes may be selected. The default sorting
  of &quot;None&quot; means that a predefined order is used for the entries in
  the table. When sorting by &quot;Popularity&quot;, the number of occurrences
  of compounds which have non-null values for the currently selected activities
  is used as the sort order, those most abundant being shown first.
  &quot;Weight&quot; causes sorting by the molecular weight of the fragments,
  while &quot;Activity&quot; causes sorting by highest activity first, with the
  first selected activity taking precedence.</p>

<p>Up to three activities may be shown at once. By default only the first
  activity is shown. Each of the selected activities may be assigned a color
  scheme, from the selection of &quot;Heat-map&quot;, &quot;Magenta&quot; and
  &quot;Greyscale&quot;, which are depicted above. The scale may optionally be
  inverted by clicking the so-named checkbox. Underneath the color schemes is
  shown a color sampling palette, to provide an idea of the activity values
  which correspond to certain colors.</p>

<p>Each of the activity fields defined when generating the report is
  represented. If there is more than one activity value, then additional fields
  are automatically generated, one for each pairwise combination of activity
  values, in the form of &quot;A vs. B&quot;, &quot;B vs. A&quot;, etc. These
  computed values are used to plot selectivity. The color coding is chosen to
  represent the extent to which the activity of the first value is greater than
  the second value.</p>

<p>There are two ways in which color-coded activity data is shown in the
  correlation table: by coloring the background with the average activity value
  of the compounds, and by producing a &quot;cartwheel&quot; for each cell. The
  cartwheels are divided into rungs (per activity) and spokes (per compound),
  and are a particularly effective way of collapsing a large amount of
  information into a small space:</p>
  <div align="center"><img src="sar/tabactivity4.png" /></div>

<p>Underneath the main table is the <b>Constraints</b> section, which can be
  used to exclude certain scaffolds and substituents from the table. Clicking
  on any of the degrees of freedom opens up a small popup:</p>
  <div align="center"><img src="sar/tabactivity5.png" /></div>

<p>Clicking on any of the fragments toggles its selection state. For example,
  clicking on the &quot;R1-CH3&quot; and &quot;R1-H&quot; fragments so that
  both of them are toggled on causes the correlation table to be updated so
  that only molecules with either methyl or hydrogen at the R1-position are
  included, and all other compounds are taken out of the table. When none (or
  all) of the fragments are selected, no constraint is applied.</p>
<a id="TabSuggestions"></a>
<h2>Suggestions</h2>

<p>The <b>Suggestions</b> tab consists of a list of hypothetical molecules,
  constructed from available pieces, which are predicted to have a high
  probability of activity.</p>

<p>The pool of hypothetical molecules is prepared by enumerating all of the
  input molecules, and performing single-point mutations at each of the
  substituent positions, with each of the R-groups that have are observed in
  the equivalent position for some other molecule in the dataset. The unique
  list of chimeric molecules is then scored according to an estimate of
  probability, scaled and balanced to match the distribution of activities
  found in the input set. Hypothetical compounds with a probability value of
  0.5 have an even chance of having better-than-average activity, while those
  with higher probability values are increasingly likely to have higher
  activities.</p>

<p>The list is presented in the following way:</p>
  <div align="center"><img src="sar/tabsuggestions.png" /></div>

<p>The most promising candidates are listed first, and only those with a
  probability of greater than 0.5 are considered. All of the compounds are
  different from those in the actual dataset.</p>

<p>The <b>Activity</b> of interest can be selected. By default the list
  contains hypothetical molecules with any scaffold, but by clicking on an
  entry in the <b>Filter Scaffolds</b> section, the list can be narrowed to one
  scaffold at a time. Sometimes one or more of the scaffolds contributes no
  hypothetical molecules which make the list, and these are shown with a white
  background, and are not selectable.</p>
<a id="TabExplore"></a>
<h2>Explore</h2>

<p>The <b>Explore</b> tab plots the relative similarities and activities of
  all other molecules in the dataset around a single selected molecule, and
  allows the set to be navigated interactively:</p>
  <div align="center"><img src="sar/tabexplore.png" /></div>

<p>When the tab is opened, the first molecule is selected by default, which
  is plotted as a single point in the cross-hairs of a large circle. All other
  molecules are plotted as individual white dots.</p>

<p>Molecules which have higher activity than the current molecule are plotted
  <i>above</i> the vertically bisecting line, while those with lower activity
  are plotted <i>below</i>.</p>

<p>To the left of the horizontal divider are plotted molecules which have the
  <i>same</i> scaffold as the selected molecules. The distance to the left is
  proportional to the dissimilarity of the decorating R-group substituents. To
  the right are plotted molecules which have <i>different</i> scaffolds. The
  distance to the right is proportional to the dissimilarity of the scaffold
  itself, if both are assigned, or the whole molecule otherwise.</p>

<p>Moving the mouse cursor over any of the white dots causes a popup window
  to appear, which provides information about the molecules in that region of
  the plot. Left-clicking on a point will navigate to the underlying molecule,
  and redraws the explore plot accordingly.</p>

<p>On the top right of the page, the activity which is under scrutiny may be
  selected, if there are multiple activity values present. Information about
  the currently selected molecule is shown.</p>

<p>If there are any ID fields, then a search box is presented, which allows a
  compound to be quickly located and made the new center of attention. After
  the current compound has been changed for the first time, a <b>Back</b>
  button is made available. Selected compounds are shown with a thicker black
  border. Left-clicking on any of the compounds while holding the Ctrl-key
  toggles the compound selection.</p>
<a id="TabGraphs"></a>
<h2>Graphs</h2>

<p>Graphs can be composed from any two supplied or calculated properties. The
  first section, the <b>Graph Selector</b>, allows the X- and Y-axes to be
  selected. The available options consist of all of the activities and
  properties which were submitted as part of the report. Molecular weight and
  calculated log P are also added. For each activity, and the
  &quot;efficiency&quot; property is calculated, which is obtained by dividing
  the normalized activity value (0&ndash;1) by the number of heavy atoms in the
  molecule.</p>
  <div align="center"><img src="sar/tabgraph1.png" /></div>

<p>To the right of the axes are shown the series, of which there is one for
  each scaffold, with an extra case reserved for molecules with no assigned
  scaffold. By default each of the scaffolds is plotted in a different color,
  which can be changed by clicking on the desired color. Clicking on the
  &quot;X&quot; mark causes the series to be not shown.</p>

<p>The graph itself is shown underneath. This example plots an efficiency
  value against calculated log P:</p>
  <div align="center"><img src="sar/tabgraph2.png" /></div>

<p>Moving the mouse pointer over any of the dots brings up a popup with
  information about the compound. Left-clicking on a dot switches to the
  <b>Explore</b> tab, and makes the underlying dot the new current compound.
  Holding the Ctrl-key and left-clicking on a dot toggles its selection
  state.</p>
<a id="TabFragments"></a>
<h2>Fragments</h2>

<p>In the <b>Fragments</b> tab is shown a hierarchical breakdown of all of
  the input molecules according to linear fragmentation rules [Schuffenhauer
  2007]:</p>
  <div align="center"><img src="sar/tabfrag.png" /></div>

<p>Each of the input molecules is a leaf node on the tree, and each unique
  final decomposition fragment is a root node. Branch nodes can be clicked open
  and shut using the [+] and [-] buttons. The root nodes have extra buttons,
  [++] and [--], which apply to all of the descendent nodes, not just their
  immediate descendents.</p>

<p>To the left of the molecular structures of non-leaf nodes is a compact
  histogram of activity values for each of the molecules. In the case of
  multiple activities, these are presented in the same order, top-down, as in
  other tabs.</p>

<p>To the right of the fragment molecular structures is shown the total
  number of molecules which feature this fragment within the linear
  sequence.</p>

<p>Note: the fragmentation sequence shown in this tab is the raw data which
  is used by the scaffold detection algorithm used for the Structure-Activity
  Report. It should not be confused with the actual scaffold assignment, which
  undergoes additional levels of processing in order to determine the optimal
  scaffold collection.</p>
<a id="TabData"></a>
<h2>Data</h2>

<p>The <b>Data</b> tab presents a list of all of the input molecules, which
  are segregated into sections based on the scaffold which they are assigned
  to. The first section is devoted to <b>Search</b> features, which is followed
  by one section for each scaffold:</p>
  <div align="center"><img src="sar/tabdata1.png" /></div>

<p>Searching can be done based on exact matching of ID fields, or matching
  sets of molecules with certain numeric values. It is possible to select a
  numeric field, and search for a specific numeric value (with an optional
  tolerance) or enter a range of values to select by. The current selection
  state can be affected in several ways, which is explained on the page
  itself.</p>

<p>Selected compounds are highlighted on the page itself. If there is more
  than one selected compound, the <b>View</b> button can be used to open a page
  which shows the selected compounds, or <b>OpenSDF</b> can be used to compile
  an MDL SD-file, containing the structures and basic information about the
  selected molecules.</p>

<p>For the scaffold sections, note that the portions of the molecules which
  are assigned to a scaffold are colored in blue, while the remainder is black.
  Also, the scaffold portions of each of the molecules are depicted and aligned
  in the same way, while the substituents are arranged according to
  conventional aesthetics.</p>

<p>Molecules which are not assigned to any scaffold are shown in the section
  which follows the scaffolds. They have no special color coding or 2D
  alignment:</p>
  <div align="center"><img src="sar/tabdata2.png" /></div>

<p>At the bottom of the page are hyperlinks to download any of the SD files
  which were generated during the report creation:</p>
  <div align="center"><img src="sar/tabdata3.png" /></div>
  <!-- ============================ REFERENCES ============================= -->
<a id="Ref"></a>
<h1>References</h1>
  <table class="ref">
    <tr>
      <td valign="top">[Clark&nbsp;2006]</td>
      <td valign="top">
        (a) Clark, A.M., Labute, P., Santavy, M.; 2D Structure Depiction; <i>J.
        Chem. Inf. Model. 46</i> (<b>2006</b>) 1107&ndash;1123;<br />
        (b) <a href="http://www.chemcomp.com/journal/depictor.htm">&quot;2D
        Structure Depiction in MOE&quot;</a>
      </td>
    </tr>
    <tr>
      <td valign="top">[Schuffenhauer&nbsp;2007]</td>
      <td valign="top">Schuffenhauer, A; Ertl, P.; Roggo, S.; Wetzel, S.; Koch
      M.A.; Waldmann, H.; The Scaffold Tree - Visualization of the Scaffold
      Universe by Hierarchical Scaffold Classification; <i>J. Chem. Inf. Model.
      47</i> (<b>2007</b>) 47&ndash;58.</td>
    </tr>
    <tr>
      <td valign="top">[Clark&nbsp;2009]</td>
      <td valign="top">Clark, A.M.; Labute, P.; Detection and Assignment of
      Common Scaffolds in Project Databases of Lead Molecules; <i>J. Med. Chem.
      52</i> (<b>2009</b>) 469&ndash;483.</td>
    </tr>
  </table><!-- START MOE_FOOTER -->
  <div class="MOE_FOOTER">
    <img src="../images/ccgicon.png" /> <a href="../index.htm"></a> <a href=
    "../legal.htm"></a> &copy;<span class="versionyear"></span> <a href="http://www.chemcomp.com"></a>. All
    rights reserved.<br />
    <a href="mailto:info@chemcomp.com"></a>
  </div><!-- END MOE_FOOTER -->
</div>
</div>
</body>
</html>

