<!DOCTYPE html>
<html>

<!--
!!    MOE On-Line Manuals
!!    COPYRIGHT (C) CHEMICAL COMPUTING GROUP ULC.  ALL RIGHTS RESERVED.
!!-->
<head>
  <meta http-equiv="x-ua-compatible" content="IE=9" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="../include/manstyle.css" />
  <link rel="icon" type="image/png" href="../images/ccgicon.png" />
  <link rel="shortcut icon" type="image/png" href="../images/ccgicon.png" />
  <title>Generating and Analyzing Conformations</title>
  <meta name="keywords" content="panel: Conformational Search" />
  <meta name="keywords" content="panel: Conformation Geometries" />
  <meta name="keywords" content="main_keywords: conformations" />
  <meta name="keywords" content=
  "main_keywords: systematic, stochastic, low-mode, search, LowModeMD" />
  <meta name="keywords" content="main_keywords: superpose" />
  <meta name="keywords" content="keywords: align, alignment" />
  <meta name="keywords" content=
  "keywords: hybrid monte carlo, minimization, MM, QM, quantum, ONIOM" />
  <meta name="keywords" content="keywords: duplicate, property, descriptor" />
  <meta name="keywords" content=
  "keywords: rotatable bond, distance, angle, dihedral" />
  <meta name="keywords" content=
  "keywords: frequency, vibrational, forcefield, amide" />
  <meta name="keywords" content=
  "keywords: RMSD, measure, iteration, gradient, limit, strain, stereo" />
</head>
<body>
<div class="center-page">
  <!-- START MOE_HEADER -->
  <div class="MOE_HEADER">
    <a href="../index.htm"><img src="../images/ccglogo.png" /></a>
    <a href="../index.htm"><div class="moeversion"></div></a>
    Generating and Analyzing Conformations
  </div>
<!-- END MOE_HEADER -->
<div class="content">
  <ul>
    <li><a href="#Introduction">Introduction</a></li>
    <li>
      <a href="#Methods">Theory and Methods</a>
      <ul>
        <li><a href="#Systematic">Systematic Search</a></li>
        <li><a href="#Stochastic">Stochastic Search</a></li>
        <li><a href="#LowModeMD">LowModeMD Search</a></li>
        <li><a href="#RefineOnly">Refine Structure</a></li>
        <li><a href="#Descriptors">Descriptors</a></li>
      </ul>
    </li>
    <li>
      <a href="#Run">Running Conformational Search</a>
    </li>
    <li>
      <a href="#ConfGeometries">Analyzing Conformation Geometries</a>
      <ul>
        <li><a href="#ConfPanel">Conformation Geometries Panel</a></li>
        <li><a href="#Measuring">Measuring Structural Properties</a></li>
      </ul>
    </li>
    <li><a href="#References">References</a></li>
  </ul>
<a id="Introduction"></a>
<h1>Introduction</h1>

<p>The conformations available to a molecule dramatically affect activity,
  reactivity or other properties. Conformations responsible for a particular
  property may not always correspond to the global minimum, and, in some cases,
  an ensemble of conformations may be responsible for an observed behavior.
  Thus, a single, minimum energy conformation may be insufficient for
  representing a molecule. The purpose of the Conformational Search application
  is to generate energetically reasonable 3D atomic configurations of molecular
  systems comprising small molecules, multiple molecules, macrocycles, and
  protein loops, with or without geometric constraints or fixed atoms.</p>

<p>The conformation space of a molecular system is continuous and cannot be
  represented easily. Fine discrete conformational samples, say of the
  rotatable bonds, are impractical for all but the smallest of systems, and
  systematically generating such &quot;coverage collections&quot; for large
  complex systems is an unsolved problem. Conformational Search produces a
  discrete sampling of the space confined to local minima of the potential
  energy function. For many properties, a collection of low energy local minima
  is often a good representative of the entire conformation space.</p>

<p>The Conformational Search application contains three methods for
  generating conformations, the output of each of which is subjected to energy
  minimization:</p>
  <ol>
    <li><i>Systematic Search</i>. Systematic generation of rotatable bond
    dihedral angle combinations.</li>
    <li><i>Stochastic Search</i>. Random assignment of dihedral angle
    combinations, even for rings, and stereochemistry inversions, where
    permitted.</li>
    <li><i>LowModeMD Search</i>. A short molecular dynamics simulation using
    velocities with little kinetic energy on the high-frequency vibrational
    modes.</li>
  </ol>

<p>Each method has its advantages, disadvantages, and unique capabilities, as
  summarized in the following table. In the table, a &quot;Y&quot; value
  indicates that the method is good at dealing with the condition while an
  &quot;N&quot; indicates that the method is not particularly good (although it
  may work formally).</p>
<table class="titlebar">
  <tr>
    <th>Property</th>
    <th>Systematic</th>
    <th>Stochastic</th>
    <th>LowModeMD</th>
  </tr>
  <tr>
    <td>Systematic Sampling</td>
    <td>Y</td>
    <td>N</td>
    <td>N</td>
  </tr>
  <tr>
    <td>Single Bond Rotation</td>
    <td>Y</td>
    <td>Y</td>
    <td>Y</td>
  </tr>
  <tr>
    <td>Amide Bond Rotation</td>
    <td>Y</td>
    <td>Y</td>
    <td>N</td>
  </tr>
  <tr>
    <td>Double Bond Rotation</td>
    <td>Y</td>
    <td>Y</td>
    <td>N</td>
  </tr>
  <tr>
    <td>Chiral Center Inversion</td>
    <td>N</td>
    <td>Y</td>
    <td>N</td>
  </tr>
  <tr>
    <td>Small Ring Conformations</td>
    <td>N</td>
    <td>Y</td>
    <td>Y</td>
  </tr>
  <tr>
    <td>Macrocycle Conformations</td>
    <td>N</td>
    <td>N</td>
    <td>Y</td>
  </tr>
  <tr>
    <td>Protein Loop Conformations</td>
    <td>N</td>
    <td>N</td>
    <td>Y</td>
  </tr>
  <tr>
    <td>Disconnected Systems</td>
    <td>N</td>
    <td>N</td>
    <td>Y</td>
  </tr>
  <tr>
    <td>Restraints and Tethers</td>
    <td>N</td>
    <td>N</td>
    <td>Y</td>
  </tr>
  <tr>
    <td>Complex Non-bonded Networks</td>
    <td>N</td>
    <td>N</td>
    <td>Y</td>
  </tr>
</table>

<p>Because of its generality and efficiency, LowModeMD Search is the default
  and recommended method for conformation generation.</p>

<p><b>Note:</b> For very large databases of molecules, <a href=
  "confgui.htm">Conformation Import</a>, an application designed for
  high-throughput generation of conformers, may be appropriate.</p>
  <!-- THEORY AND METHODS -->
<a id="Methods"></a>
<h1>Theory and Methods</h1>

<p>In all methods, a Stochastic Sampling protocol is applied to each molecule
  under consideration and proceeds as follows:</p>
<ol>
  <li>[Initialize] Set the conformer list <i>C</i> to empty. For the
  Systematic Search, identify all rotation bonds excluding rings and
  determine a collection of dihedral angles for each rotation bond. For
  Stochastic Search, identify all rotation bonds including rings and
  invertible stereo centers. Energy minimize the system until the RMSD
  gradient falls below the RMS Gradient test parameter.</li>
  <li>[Generate] Each particular method generates a single conformation in
  its own way;
    <ul>
      <li><i>Systematic Search</i>. For a randomly chosen dihedral angle,
      systematically rotate about that bond in discrete angular increments
      and perform an energy minimization of the system. <!--
Generate the
next combination of dihedral angles and
energy minimize the system briefly in dihedral coordinates.</li>
--></li>
      <li><i>Stochastic Search</i>. Randomly rotate all bonds (including ring
      bonds) and randomly invert invertible stereochemistry centers.</li>
      <li><i>LowModeMD Search</i>. Perform a brief molecular dynamics
      simulation with velocities initialized to low-frequency vibrational
      modes.</li>
    </ul>
  </li>
  <li>[Minimize] Energy minimize the system in Cartesian coordinates until
  the RMS gradient falls below the MSD Gradient test parameter.</li>
  <li>[Save] If the current conformation has a strain energy greater than the
  Strain Cutoff parameter, discard the conformation. Otherwise, check for
  duplicates in the conformer list, <i>C</i>. Two conformations are
  considered duplicates if the root mean square distance between them (taking
  molecular symmetry into account) is less than the RMSD Limit parameter.
  Discard the current conformation if it is already in <i>C</i>. A separate
  conformer list is maintained for each stereochemistry configuration.</li>
  <li>[Termination] Terminate the algorithm if the total number of iterations
  exceeds the Iteration Limit parameter. For the Stochastic and LowModeMD
  methods, terminate the algorithm if no novel conformation was observed in
  Rejection Limit parameter consecutive iterations. Otherwise, go to
  Step&nbsp;2.</li>
  <li>[Descriptors] Sort the conformation list <i>C</i> by strain energy and
  calculate energetic and shape based descriptors for each conformation.</li>
</ol>

<p>We now describe each of the three methods in more detail.</p>
<a id="Systematic"></a>
<h2>Systematic Search</h2>

<p>The Systematic Search method generates molecular conformations by rotating
  non-ring bonds in a molecule by discrete dihedral increments (see below). All
  possible combinations of the dihedral increments are produced. Each such
  dihedral angle combination is subjected to dihedral angle energy minimization
  to relieve gross strain due to atom overlap, followed by an all-atom energy
  minimization. The resulting conformation is saved to the output database
  provided it meets the energetic and geometric criteria. <b>Note!</b>
  Systematic Search is intended for relatively small connected molecules with
  few rotatable bonds (due to the exponential number of configurations that
  will be generated); it is not suitable for macrocycles or large systems with
  complex non-bonded interaction networks.</p>

<p>In a given molecule, all bonds except ring bonds and bonds to terminal
  atoms are candidates for rotation. For each such bond, a list of possible
  relative dihedral angles is determined according to topological rules that
  take into account hybridization and chemical type. For example, a CH3-OH bond
  might be assigned three dihedral angles {180,60,-60} degrees. Because only
  dihedral rotations are used to generate conformations, Systematic Search
  cannot perform non-planar (chiral) inversions; however, double bonds and
  amide bonds can be optionally rotated. The following table summarizes the
  dihedral angle rules:</p>
<table class="titlebar">
  <tr>
    <th>Bond</th>
    <th>Description</th>
    <th>Angles</th>
  </tr>
  <tr>
    <td>&ndash;X</td>
    <td>Terminal atom</td>
    <td>{0}</td>
  </tr>
  <tr>
    <td>X=X</td>
    <td>Double bond</td>
    <td>{0,180}</td>
  </tr>
  <tr>
    <td>X#X &nbsp;&nbsp; X=X=X</td>
    <td>Triple bond / Allene</td>
    <td>{0}</td>
  </tr>
  <tr>
    <td>N&ndash;C=O &nbsp;&nbsp; N&ndash;C=S &nbsp;&nbsp;
    N&ndash;C=N+</td>
    <td>Amide / CNN resonance</td>
    <td>{0,180}</td>
  </tr>
  <tr>
    <td>&ndash;O&ndash;O&ndash; &nbsp;&nbsp;
    &ndash;S&ndash;S&ndash;</td>
    <td>Peroxide / Disulfide</td>
    <td>{90,-90}</td>
  </tr>
  <tr>
    <td>sp3-sp3</td>
    <td>E.g. &ndash;CH2&ndash;CH2&ndash;</td>
    <td>{180,60,-60}</td>
  </tr>
  <tr>
    <td>aro*&ndash;X</td>
    <td>Ortho substituted</td>
    <td>{45,-45,135,-135}</td>
  </tr>
  <tr>
    <td>aro&ndash;CO2 &nbsp;&nbsp; aro&ndash;OMe &nbsp;&nbsp;
    aro&ndash;NH2</td>
    <td>No ortho substituents</td>
    <td>{0,180}</td>
  </tr>
  <tr>
    <td>aro&ndash;X</td>
    <td>No ortho substituents</td>
    <td>{45,-45,135,-135}</td>
  </tr>
  <tr>
    <td>X&ndash;X</td>
    <td>E.g. sp2&ndash;sp3</td>
    <td>{0,60,120,180,-60,-120}</td>
  </tr>
</table>

<p>It should be kept in mind that the listed angles are merely starting
  points for subsequent energy minimizations. Consequently, precise angles are
  not required since the conformation will be refined with the forcefield to
  the nearest local minimum. Typically, most (or all) of the local minima can
  be identified (for small molecules not affected by restraints or tethers);
  however, different starting conformations may produce slightly different
  results (due to variations in bond lengths and angles).</p>

<p>Despite the systematic nature of the method, Systematic Search is
  generally not the best method for generating conformations. This is due to
  the fact that there is inherent bias in the dihedral angle lists and no
  guarantee that all local minima will be identified. A finer set of angle
  increments could be used in principle, however, fine lists quickly become
  impracticable because of the exponential growth of the number of generated
  configurations. Even with the coarse lists actually used, Systematic Search
  will spend most of its time refining conformations that are far from the
  global minimum and that will ultimately be rejected.</p>

<a id="Stochastic"></a>
<h2>Stochastic Search</h2>

<p>The Stochastic Search method generates conformations by randomly rotating
  all bonds (including ring bonds) and randomly inverting tetrahedral centers
  followed by an all-atom energy minimization. The resulting conformation is
  saved to the output database provided it meets the energetic and geometric
  criteria. This method is superior to the RIPS method [Ferguson&nbsp;1989]
  which generates new molecular conformations by randomly perturbing the
  Cartesian coordinates of each atom by some small amount. <b>Note!</b>
  Stochastic Search is intended for moderately sized connected molecules; it is
  not suitable for macrocycles or large systems with complex non-bonded
  interaction networks. However, the Stochastic Search method is capable of
  generating enantiomers (unlike the Systematic and LowModeMD methods).</p>

<p>Typically, Stochastic Search is good at locating most of the local minima
  of flexible (small) molecules, including ring conformations and invertible
  tetrahedral centers (like tertiary nitrogens). It does not suffer from the
  biases of Systematic Search since continuous dihedral angle sampling is used
  nor is it sensitive to the starting conformation. However, numerous samples
  may be required to adequately search the conformation space of flexible
  molecules. Stochastic Search is generally not the most efficient method for
  generating conformations because, like Systematic Search, it spends most of
  its time refining conformations that are far from the global minimum and that
  will ultimately be rejected.</p>

<a id="LowModeMD"></a>
<h2>LowModeMD Search</h2>

<p>The LowModeMD Search method [Labute&nbsp;2010] generates conformations
  using a short ~1&nbsp;ps run of Molecular Dynamics (MD) at constant
  temperature [Allen&nbsp;1987] followed by an all-atom energy minimization.
  The resulting conformation is saved to the output database provided it meets
  the energetic and geometric criteria. <b>Note!</b> LowModeMD Search is
  intended for large, possibly disconnected, and complex structures like
  macrocycles and protein loops but it is also very efficient for detailed
  small molecule analysis. However, chiral inversions as well as amide and
  double bond rotations will very rarely result.</p>

<p>The key to the success and efficiency of the LowModeMD method lies in the
  nature of the initial MD velocities: randomly directed kinetic energy is
  given mainly on the <i>low-frequency vibrational modes</i> of the molecular
  system causing rapid and more realistic conformational transitions. The
  second derivative matrix <b>G</b> of the potential energy function of the
  system is evaluated at the current set of coordinates (presumed to be near a
  local energy minimum). Let <b>M</b> be a diagonal matrix of atomic masses in
  which fixed atoms are taken to have infinite mass. Diagonalize the
  mass-weighted second derivative matrix</p>

<p class="center"><b>M</b><sup>-1/2</sup> <b>G</b> <b>M</b><sup>-1/2</sup> =
  <b>Q</b><sup>T</sup> <b>D</b> <b>Q</b></p>

<p>where <b>Q</b> is the orthogonal matrix of vibrational modes and <b>D</b>
  is the diagonal matrix of force constants. A filter function, <i>f</i>, is
  applied to <b>D</b> which maps low-frequency force constants to near unit
  values and high-frequency force constants to near-zero values. For a given
  velocity vector <i>v</i>, the velocity filter transformation</p>

<p class="center"><b>Q</b><sup>T</sup> <i>f</i>(<b>D</b>) <b>Q</b>
  <i>v</i></p>

<p>will heavily dampen kinetic energy along the high-frequency vibrational
  modes. Randomly generated Maxwell-Boltzmann velocities, scaled to 300&nbsp;K
  and thusly transformed, are used in the subsequent MD simulation.</p>

<p>LowModeMD Search is similar in spirit to the Stochastic Search and the
  Hybrid Monte Carlo methods except that detailed information about the
  possibly complex non-bonded interaction network, forcefield
  restraints/tethers, macrocyclic structure and concerted motions are taken
  into account. LowModeMD Search is most similar to the LMOD method
  [Kolossvary&nbsp;1996] with some important differences:</p>
<ol>
  <li>LMOD made linear coordinate perturbations along eigenvectors causing
  unrealistic distortions that prevented proper modeling of concerted
  motions. LowModeMD Search uses MD for the perturbation.</li>

  <li>LMOD originally attempted to systematically search along all
  2<sup>k</sup> combinations of low-mode eigenvectors which rapidly became
  impracticable necessitating the introduction of a stochastic sampling.
  LowModeMD Search is designed to be stochastic with no partial or incomplete
  enumeration attempt (this allows for much greater efficiency).</li>

  <li>LMOD used large-scale iterative eigensystem calculations which can be
  slow to converge and/or memory intensive. LowModeMD Search uses an entirely
  implicit Chebyshev filtering technique directly on the velocity vector thus
  eliminating the need for any explicit eigensystem determination.</li>
</ol>

<p>Typically, LowModeMD Search is very good at locating most of the local
  minima of arbitrarily complex multicomponent systems (provided sufficient
  sampling is conducted). This is because LowModeMD Search spends most of its
  time on conformations near the relevant and realistic low energy states or
  transitions between them. There are no rule-based biases; however, it is
  assumed that the conformations of interest are connected by low-frequency
  vibrational mode transitions. This assumption prevents stereochemistry
  inversions and other stiff interconversions, but in most applications this
  assumption is quite desirable. For these reasons, LowModeMD Search is the
  recommended method for most conformational search applications.</p>

<a id="RefineOnly"></a>
<h2>Refine Structure</h2>

<p>The Refine Structure process generates unique, low-energy molecular
  conformations from one or more structures contained in the input database by
  the following process:</p>

<ol>
  <li>Load a structure from the input database.
  </li>
  <li>Minimize the system in Cartesian coordinates using classical (i.e. the
  current forcefield) or quantum mechanics (QM). Forcefield minimizations
  proceed until the RMS gradient falls below the MSD Gradient test parameter.
  QM minimizations proceed until the appropriate convergence criteria is
  reached or the iteration limit is exceeded.
  </li>
  <li>If the resulting conformation has a strain energy higher than the
  Strain Cutoff parameter, or if it is a duplicate of a previously seen
  conformer it will be discarded.
  </li>
  <li>Terminate the algorithm when all structures have been read from the
  input database.</li>
</ol>

<p>The resulting conformers are written to the output database along with
  energy and structural descriptors. Note that the Refine Structure process
  with a different energy method might reduce the number of conformers
  produced.</p>

<p>One possible use of Refine Structure would be to minimize a molecular
  dynamics trajectory to yield a set of low-energy conformers. Another would be
  to use the classically-generated conformers as input to a QM optimization.
  This allows the user to perform QM-based conformational analysis in a
  reasonable amount of time. If MOE is running in
  <a href="../install/smp_inst.htm">MPU mode</a> or on a
  <a href="../moe/hpc.htm">queueing system</a>
  QM refinement can process multiple input conformers simultaneously.
</p>

<a id="Descriptors"></a>

<h2>Descriptors</h2>

<p>A number of descriptors are saved along with each conformation as it is
  generated. These descriptors are useful for analysis of the results.</p>
<table class="titlebar">
  <tr>
    <th>Name</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><tt>E</tt></td>
    <td>The value of the potential energy of the
    conformation.</td>
  </tr>
  <tr>
    <td><tt>dE</tt></td>
    <td>The strain energy of the conformation relative to
    the lowest energy conformation with the same stereochemistry
    configuration.</td>
  </tr>
  <tr>
    <td><tt>chi</tt></td>
    <td>An integer encoding the stereochemistry
    configuration of the conformation; identical <tt>chi</tt> values imply
    identical stereochemistry configurations.</td>
  </tr>
  <tr>
    <td><tt>rgyr</tt></td>
    <td>The radius of gyration of the conformation.</td>
  </tr>
  <tr>
    <td><tt>glob</tt></td>
    <td>The globularity of the conformation: the ratio of
    the smallest principal moment of inertia to the largest. Values near zero
    indicate extended conformations.</td>
  </tr>
  <tr>
    <td><tt>ecc</tt></td>
    <td>The eccentricity of the conformation: the ratio of
    the second smallest principal moment of inertia to the largest.</td>
  </tr>
  <tr>
    <td><tt>mseq</tt></td>
    <td>An integer encoding the input molecule number
    (which is useful when more than one molecule is subjected to
    conformational search).</td>
  </tr>
</table>

<p>
  If there are fixed atoms in the system then the value of <tt>E</tt> and
  <tt>dE</tt> may be different from the energy without fixed atoms. The values
  of <tt>rgyr</tt>, <tt>glob</tt> and <tt>ecc</tt> may be calculated on the
  entire system or on just the free (unfixed) atoms depending on a configurable
  option. <!-- RUNNING CONFORMATIONAL SEARCH -->
</p>

<a id="Run"></a>
<h1>Running Conformational Search</h1>

<p>To run Conformational Search, perform the following. If multiple molecules
  are to be subjected to Conformational Search, then prepare a Molecular
  Database containing a reasonable 3D conformation of each molecule. Otherwise,
  if the contents of the MOE Window are to be used as input data then:</p>
<ol>
  <li>Make sure that the MOE Window contains no data other than the molecular
  system under study. The data must be a reasonable 3D starting
  conformation</li>
  <li>Select and/or configure the <a href="../moe/pot.htm">forcefield and the
  electrostatic model</a> (implicit solvent, gas phase, etc.).</li>
  <li>Decide which atoms are to be fixed, restrained or tethered using
  <a href="../moe/pot.htm#Restraints">forcefield restraints</a>.</li>
  <li>Make sure that atom- and bond-stereochemistry is correctly assigned
  using the <a href="../moe/molsystems/build.htm">Builder</a>.</li>
  <li>Choose <span class="nobr"><b>MOE | Compute | Conformations |
  Search</b></span>.</li>
</ol>

<img src="confsrch/csearch.png" alt="Conformation Search Panel" class="center" />
<table class="noborder">
  <tr>
    <td><b>Output Database</b></td>
    <td>The name of the molecular database file that will
    contain the generated conformations, energies and descriptors. This can
    either be a new database or an existing one in which case the contents
    will be overwritten. If <b>Open Database Viewer</b> is enabled, the
    output database will be displayed in a Database Viewer when the search
    begins. The output fields are the Descriptors described above. <!--
The following fields will be written
to the database:

<p>
<center><table class="titlebar">
<tr>
<th>field</th>
<th>Description</th>
<tr>
<td><b><tt>mol</tt></b></td>
<td>A molecular conformation.
<tr>
<td><b><tt>mseq</tt></b></td>
<td>An integer encoding the input molecule number
(which is useful when more than one molecule is subjected to conformational
search).
<tr>
<td><b><tt>E</tt></b></td>
<td>The potential energy of the conformation
(in kcal/mol) determined
by the <a href="../moe/pot.htm">Potential Setup</a> window.
<tr>
<td><b><tt>dE</tt></b></td>
<td>The strain energy of the conformation (in kcal/mol).
This is defined to
be the energy of the conformation minus the smallest conformational energy seen
within the stereochemistry class annotated in the <tt>chi</tt> field.
<tr valign="baseline">
<td><b><tt>chi</tt></b></td>
<td>An integer indicating the stereochemistry class of
the conformation.
<tr valign="baseline">
<td><b><tt>rgyr</tt></b></td>
<td>The radius of gyration of the conformation in &Aring;.
<tr valign="baseline">
<td><b><tt>glob</tt></b></td>
<td>The globularity of the conformation between 0
(extended) and 1 (globular).
<tr valign="baseline">
<td><b><tt>ecc</tt></b></td>
<td>The eccentricity of the conformation in [0,1].
</table></center>
</tr>
!!--></td>
  </tr>
  <tr>
    <td><b>Input&nbsp;Data</b></td>
    <td><p>The source of the molecular data for Conformational
    Search. <b>MOE</b> means that the current molecular data in the MOE
    window will be used; this option must be used if fixed atoms and tethers
    are required. <b>MDB File</b> means that each entry in the file specified
    to the right is to be interpreted as a 3D conformation of a molecular
    system for conformational search. If MOE is running in
    <a href="../install/smp_inst.htm">MPU mode</a>, multiple
    input structures will be processed simultaneously.</p>

    <p><b>Note:</b> LowModeMD accepts multiple fragments as input. In some input
    data, e.g. SD files, multiple components can be found. It is recommended
    to <a href="../mdb/wash.htm">wash</a> structures first before performing
    conformational analysis and otherwise ensure that a single fragment is
    present (unless it is truly intended to perform conformational search on
    several structures concurrently).</p>

    <p>If the <b>field</b> menu is available, it can be used to specify the
    database field that contains the input structures. By default it is the
    first available structure field.</p>

    <p>If <b>Selected entries only</b> is enabled, only selected entries from
    the specified MDB File will be processed.</p>

    <p>If <b>Copy input data fields to output conformations</b> is enabled, the
    data fields from the specified MDB File will be copied to each
    conformation in the Output Database. This option does not apply to data
    from the MOE Window.</p>

    <p>If <b>Calculate forcefield partial charges</b> is enabled, partial
    charges will be automatically calculated for the molecular system
    (overriding any partial charges associated with the atoms); otherwise,
    the existing partial charges will be used.</p>

    <p>If <b>Rigid Body</b> is enabled, atoms will be partitioned into rigid
    body classes according to the specified mode: <b>Tag, Domain, Chain,
    Molecule, Planar,</b> or <b>Set</b>. In <b>Set</b> mode, all sets
    matching the patterns (including wildcards) that are specified in the
    text box will be used to determine the rigid body classes. The text box
    drop-down contains commonly-used sets, which can be used instead of
    specifying a pattern.</p>

    <p>If <b>Fixed OH Bond Length</b> is enabled, all OH bonds will remain fixed
    at their input geometry lengths.</p>

    <p>If <b>Rigid Water Molecules</b> is enabled, no vibration calculations for
    water molecules will be performed.</td></p>
  </tr>
  <tr>
    <td><b>Method</b></td>
    <td><p>Determines the method to use to generate conformations:
    <b>Systematic</b>, <b>Stochastic</b>, <b>LowModeMD</b> or <span class=
    "nobr"><b>Refine Only</b></span>. Use <b>LowModeMD</b> for large or
    complex systems and the others for small molecules; use <b>Systematic</b>
    only for molecules with few rotatable bonds.</p>

    <p>If <b>HMR</b> is enabled, Hydrogen Mass Repartitioning will be used to
    distribute 2 atomic mass units from heavy atoms to connected hydrogen
    atoms to speed up LowModeMD calculations.</p>

    <p>For LowModeMD sampling, the value of <b>T</b> (temperature) can be
    optionally adjusted.  The default is to sample at 300K.</p>

    <p>If <b>Allow amide bond rotation</b> is enabled, amide bonds and other
    conjugated bonds will be rotated during the search. This does not apply
    to the LowModeMD method. Press the <b>?</b> button to select in the MOE
    Window the atoms to which this option will apply.</p>

    <p>If <b>Allow unconstrained double rotation</b> is enabled, double bonds
    with no stereochemistry constraints will be rotated during the search.
    This option does not apply to the LowModeMD method. Press the <b>?</b>
    button to select in the MOE Window the atoms to which this option will
    apply. Note that unconstrained bonds involving 2-coordinated atoms (e.g.
    nitrogen atoms) are always rotated, independent of the setting of this
    option.</p>

    <p>If <b>Invert unconstrained sp3 stereo centers</b> is enabled, chiral
    centers with no stereochemistry constraints will be inverted during the
    search. This does not apply to the Systematic and LowModeMD methods.
    Press the <b>?</b> button to select in the MOE Window the atoms to which
    this option will apply.</p>

    <p>If <b>Enforce chair conformations</b> is enabled, the only conformations
    that will be retained will be those whose rings contain all single bonds
    that are in a chair conformation. This does not apply to the Systematic
    method. Press the <b>?</b> button to select in the MOE Window the atoms
    to which this option will apply.</p>

    <p>If <b>Refine with QM</b> is enabled, the <span class="nobr"><b>Refine
    Structure</b></span> process will use a QM engine to generate
    low-energy structures of each conformer. Pressing the configure icon
    brings up the <span class="nobr">
    <a href="qmconfig.htm#QMCalcOptions">QM Calculation Options</a></span>
    panel.  This calculation is performed after
    the forcefield-based conformer generation completes.</p></td>
  </tr>
  <tr>
    <td><b>Rejection Limit</b></td>
    <td><p>Specifies how many contiguous attempts should be made to
    generate a new conformation prior to terminating the search. If a value
    <i>k</i> is specified, then if <i>k</i> contiguous attempts at generating
    a new conformation result in no new novel conformations, then the search
    will terminate. This option does not apply to Systematic Search.</p></td>
  </tr>
  <tr>
    <td><b>Iteration Limit</b></td>
    <td><p>Specifies the maximum number of attempts to generate a
    new conformation (independent of the novelty of each generated
    conformation).</p></td>
  </tr>
  <tr>
    <td><b>RMS Gradient</b></td>
    <td><p>Energy minimization will terminate when the root mean
    square gradient falls below the specified value.</p></td>
  </tr>
  <tr>
    <td><b>MM&nbsp;Iteration Limit</b></td>
    <td><p>Sets the maximum number of energy minimization steps
    performed for each conformer energy minimization (see <a href=
    "emin.htm">Energy Minimization</a>).</p></td>
  </tr>
  <tr>
    <td><b>RMSD Limit</b></td>
    <td><p>If two conformations have a root mean square distance
    less than the specified value, they are considered duplicates. Molecular
    symmetry is taken into account. If there are no fixed atoms in the system
    the RMSD value is measured after optimal rigid body superposition.
    Selecting <b>Hydrogens</b>, <b>Waters</b>, and/or <b>Ions</b> includes
    hydrogen and lone pair atoms, water molecules, and/or counterions in the
    RMSD calculation for duplicate detection. Otherwise, only heavy atoms
    will be included.</p></td>
  </tr>
  <tr>
    <td><b>Energy&nbsp;Window</b></td>
    <td><p>Energy minimized conformations will be discarded if
    their potential energy is greater than <span class=
    "nobr"><i>E</i><sub>min</sub> + <i>s</i></span>, where
    <i>E</i><sub>min</sub> is the lowest energy among the minimized
    conformations and <i>s</i> is the value specified for Energy Window (in
    kcal/mol). If <b>Separate strain energy by stereo class</b> is on then
    strain energies are measured within each stereochemistry class
    separately; otherwise strain energy will be measured over all
    stereochemistry classes.</p></td>
  </tr>
  <tr>
    <td><b>Conformation Limit</b></td>
    <td><p>Specifies the limit on the resulting number of
    conformations. If a value <i>k</i> is specified then only the <i>k</i>
    lowest energy conformations will be retained (within each stereochemistry
    class) and the rest discarded.</p>

    <p>If <b>Exclude fixed atoms from shape descriptors</b> is on then only free
    (unfixed) atoms will be included in the radius of gyration, globularity
    and eccentricity descriptors; otherwise all atoms will be used.</p></td>
  </tr>
  <tr>
    <td><b>Batch</b></td>
    <td valign="top">This button brings up the
    <a href="../moe/hpc.htm#BatchPanel">Batch</a> job submit
    panel, which allows the user to create
    a batch job that can be run locally outside of MOE,
    or on a compute cluster via a queueing system such as slurm:

    <img src="confsrch/batchpanel.png" alt="Batch Panel" class="center" />

    The default job directory name will reflect the output database.
  </tr>
  <tr>
    <td valign="top"><b>Load</b></td>
    <td valign="top">Pressing the <b>Load</b> button allows the user to
    open a batch job directory and load its information:

    <img src="confsrch/loadbatch.png" alt="Load Batch" class="center" />

    This loads the starting structure into the MOE system or opens
    the input database file (as appropriate), and restores the panel settings.
  </tr>
</table>

<p>Once the panel values have been set, press <b>OK</b> to begin the
  calculation. Typically, the output will be saved into a molecular database
  (named <tt>csearch.mdb</tt> by default) which is ordered by increasing energy
  (per molecule if an MDB was used as input). If <span class="nobr"><b>Refine
  with QM</b></span> is on, a second database is created whose name is
  generated by appending <tt>_qm</tt> to the output filename (typically
  <tt>csearch_qm.mdb</tt>). Depending on the size of the molecular system, the
  search and any subsequent refinement may take some time.
</p>

<p>If <span class="nobr"><b>Refine with QM</b></span> is on, the <b>Batch</b>
  button can be used to set up the QM portion of the calculation to run
  <a href="qmconfig.htm#RunOutsideMOE">outside of MOE</a>
  according to the configuration of the corresponding
  <span class="nobr"><b>QM Engine</b></span>.
</p>

<a id="ConfGeometries"></a>
<h1>Analyzing Conformation Geometries</h1>

<p>The Conformation Geometries panel lets you analyze conformations that have
  been generated by any of the methods available in MOE and saved into a
  database. After loading a sample conformation into MOE, you can use the panel
  to conduct the following operations on the conformers in the database:</p>
<ul>
  <li>Measure distances, angles and dihedrals between selected atoms.</li>
  <li>Label atoms in the database and MOE Window for calculation
  purposes.</li>
</ul>

<p>The results of the measurements are saved back into the database. Note
  that the database <b>must</b> contain conformational data, i.e. all molecules
  in the field used for the calculations must be the same molecule; otherwise,
  incorrect values and error messages may result. If the conformations of more
  than one molecule are saved in the database, entry selection can be used to
  specify the conformations of a single distinct molecule.</p>

<a id="ConfPanel"></a>
<h2>Conformation Geometries Panel</h2>

<p>To open the Conformation Geometry panel choose <span class="nobr"><b>DBV |
  Compute | Molecule | Conformation Geometry</b></span> in the database
  containing the conformational data to measure:</p>
<img src="confsrch/confgeom.png" alt="Conformation Geometries Panel" class="center" />
<table class="noborder">
  <tr>
    <td><b>Database</b></td>
    <td>Path and filename of the database containing the
    conformations to be analyzed.</td>
  </tr>
  <tr>
    <td><b>Molecule field</b></td>
    <td>Option menu containing the list of all the molecule
    fields in the database. Select the molecule field on which to perform
    calculations.

    If <b>Selected Entries Only</b> is turned on, only selected entries in
    the Database Viewer are used (the rest are ignored).</td>
  </tr>
  <tr>
    <td><b>Measurement</b></td>
    <td>The Measurement section of the panel is used to measure
    structural features between selected atoms. Results are written to the
    database.</td>
  </tr>
  <tr>
    <td><b>Distance field</b></td>
    <td>If two atoms are selected, this field shows the names of
    the selected atoms. If Measure is pressed, this becomes the name of the
    database field that will contain the measured distances between two
    selected atoms. Any two atoms may have the distance between them
    measured.</td>
  </tr>
  <tr>
    <td><b>Angle field</b></td>
    <td>If three atoms are selected (a vertex atom and two other
    atoms bonded to it, but not forming a three-membered ring), this field
    shows the names of the selected atoms. The vertex atom will be the second
    atom listed. If Measure is pressed, this becomes the name of the database
    field that will contain the measured angles between the selected
    atoms.</td>
  </tr>
  <tr>
    <td><b>Dihedral field</b></td>
    <td>If four atoms defining a proper dihedral angle are
    selected, this field shows the names of the selected atoms. If Measure is
    pressed, this becomes the name of the database field that will contain
    the measured dihedrals between the selected atoms.

    The dihedral angle will be measured with respect to a plane containing
    the first, second and third atoms and a plane containing the second,
    third and fourth atoms. The third and fourth atoms are understood to be
    the atoms the farthest away from the viewer.</td>
  </tr>
  <tr>
    <td><b>Measure</b></td>
    <td>Measures the currently selected structural property and
    saves the results in the indicated database field.</td>
  </tr>
  <tr>
    <td><b>Auto Label</b></td>
    <td><p>Alters the names of atoms for each molecule in the
    database. Atoms will be labeled according to their element name followed
    by an integer from 1 to <i>n<sub>e</sub></i>, where <i>n<sub>e</sub></i>
    is the total number of atoms of element type <i>e</i> in the system. For
    example, if the molecule were dimethyl ether CH3OCH3, atoms would be
    named as follows: C1, C2, H1, H2, H3, H4, H5, H6, O1. Labels are
    displayed in the MOE Window. Note that atom names do not appear in the
    Database Viewer.</p>

    <p>Before doing so, MOE displays the message: <tt>Database atoms will be
    renamed. Continue?</tt> If you answer <b>Yes</b>, the atom names for each
    molecule in the database will be altered. Answering <b>No</b> cancels the
    operation.</p></td>
  </tr>
  <tr>
    <td><b>Show Labels</b></td>
    <td>Shows in the MOE Window the atom name labels of atoms.
    If any atoms are selected, the name labels display of only selected atoms
    only is changed (labels on unselected atoms are unaffected).</td>
  </tr>
  <tr>
    <td><b>Hide Labels</b></td>
    <td>Hides in the MOE Window the name labels on all
    atoms.</td>
  </tr>
</table>
<a id="Measuring"></a>
<h2>Measuring Structural Properties</h2>
  <ol>
    <li>
      <p><a href="../mdb/dbedit.htm">Load the sample conformation</a> from the
      database into MOE and select the appropriate number of atoms depending on
      whether you wish to measure distance, angle or dihedral angle:</p>

      <ul>
        <li>To measure the <b>distance</b> between two atoms, simply select the
        two atoms. Any two atoms may have the distance between them
        measured.</li>
        <li>To measure an <b>angle</b>, select three atoms: a vertex atom and
        two other atoms bonded to it (but not forming a three-membered
        ring).</li>
        <li>To measure <b>dihedrals</b>, select four atoms which define a
        proper dihedral angle. MOE calculates a dihedral angle with respect to
        a plane containing the first, second and third atoms and a plane
        containing the second, third and fourth atoms. The third and fourth
        atoms are understood to be the atoms the farthest away from the
        viewer.</li>
      </ul>
    </li>

    <li>If the selected atoms define a distance, angle or dihedral angle
    measurement, then the name of each selected atom will appear in the text
    area next to the corresponding <b>field</b> (Distance, Angle or Dihedral)
    in the Conformation Geometries panel. This text string will be used as the
    name of the field in the database, and may be modified if desired.

<p>For example, if a carbon and an oxygen are selected, the string
      <tt>C-O</tt> will appear in the Distance field and will be used as the
      database field name. (This is assuming that atoms are named according to
      their element.)</p>
    </li>
    <li>To provide more precision as to which atoms are involved in the
    selected measurement, use the <b>Auto Label</b> button to rename all atoms
    so that their element name is followed by a number. Each atom is given a
    distinct name in the molecular structure. This is done for all
    conformations in the database so that corresponding atoms have
    corresponding names. Note, however, that although the atom names are saved
    in the database, they are not displayed in the Database Viewer.

<p>Given the example above, where a carbon and oxygen are selected,
      <tt>C1-O4</tt> might now appear in the Distance field, where <tt>C1</tt>
      is the first of <i>n<sub>c</sub></i> carbons in the system, and
      <tt>O4</tt> is the fourth of <i>n<sub>o</sub></i> oxygens
      (<i>n<sub>c</sub></i> is the total number of carbon atoms in the system
      and <i>n<sub>o</sub></i> is the total number of oxygen atoms in the
      system).</p>
    </li>
    <li>Click on the <b>Measure</b> button. MOE performs the measurement for
    each entry in the specified Molecule field and saves the values to the
    database in a field whose name is specified in the Measurement section of
    the panel.</li>
  </ol>

<a id="References"></a>
<h1>References</h1>
<table class="ref">
  <tr>
    <td>[Allen&nbsp;1987]</td>
    <td>Allen, M.P., Tildesley, D.J.; <i>Computer Simulation of
    Liquids</i> (<b>1987</b>) 231&ndash;232; Oxford University Press,
    Oxford.</td>
  </tr>
  <tr>
    <td>[Ferguson&nbsp;1989]</td>
    <td>Ferguson, D.M., Raber, D.J.; A New Approach to Probing
    Conformational Space with Molecular Mechanics: Random Incremental Pulse
    Search; <i>J. Am. Chem. Soc. 111</i> (<b>1989</b>) 4371&ndash;4378.</td>
  </tr>
  <tr>
    <td>[Kolossvary&nbsp;1996]</td>
    <td>Kolossvary, I., Guida, W.C.; Low Mode Search. An
    Efficient, Automated Computational Method for Conformational Analysis:
    Application to Cyclic and Acyclic Alkanes and Cyclic Peptides; <i>J. Am.
    Chem. Soc. 118</i> (<b>1996</b>) 5011&ndash;5019.</td>
  </tr>
  <tr>
    <td>[Labute&nbsp;2010]</td>
    <td>Labute, P.; LowModeMD - Implicit Low Mode Velocity
    Filtering Applied to Conformational Search of Macrocycles and Protein
    Loops; <i>J.&nbsp;Chem. Inf. Model. 50</i> (<b>2010</b>)
    792&ndash;800.</td>
  </tr>
</table>

<h1>See Also</h1>

<p><a href="../moe/gui/mainwin.htm">MOE Window</a><br />
  <a href="../moe/molsystems/build.htm">Building and Editing
  Molecules</a><br />
  <a href="../moe/pot.htm">Potential Energy Selection and
  Configuration</a><br />
  <a href="emin.htm">Energy Minimization</a><br />
  <a href="qmconfig.htm">Configuring a QM Engine</a><br />
  <a href="../moe/hpc.htm">High-Performance Computing Framework</a><br />
  <a href="../mdb/db.htm">Molecular Database Viewer</a><br />
  <a href="confgui.htm">Conformation Import: High Throughput Conformational
  Analysis</a><br />
  <a href="../moe/prep3ddb.htm">Preparing a Conformation Database</a><br />
  <a href="../install/smp_inst.htm">MOE/cluster (MOE/smp)</a>
  </p>
<!-- START MOE_FOOTER -->
  <div class="MOE_FOOTER">
    <img src="../images/ccgicon.png" /> <a href="../index.htm"></a> <a href=
    "../legal.htm"></a> &copy;<span class="versionyear"></span> <a href="http://www.chemcomp.com"></a>. All
    rights reserved.
    <a href="mailto:info@chemcomp.com"></a>
  </div><!-- END MOE_FOOTER -->
</div>
</div>
</body>
</html>

